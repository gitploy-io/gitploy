envs:
  - name: dev
    task: ${GITPLOY_DEPLOY_TASK:=rollback}:kubernetes
    # Disable "auto_merge" to avoid merge conflict
    # when it deploys the tag behind the head.
    auto_merge: false
    # Check test and publish is succeed.
    required_contexts:
      - "publish-image"
    deployable_ref: 'v.*\..*\..*'

  - name: production
    task: ${GITPLOY_DEPLOY_TASK:=rollback}:kubernetes
    auto_merge: false
    required_contexts:
      - "publish-image"
    production_environment: true
    review:
      enabled: true
      reviewers: 
        - hanjunlee
        - noah-qa
    deployable_ref: 'v.*\..*\..*'

  - name: docs
    task: ${GITPLOY_DEPLOY_TASK:=rollback}:docs
    auto_merge: false
    description: Publish the documentation of Gitploy.
    required_contexts: []
